# Autodeploy с использованием GitHub Actions

## Получение token для deploy

1. Открыть настройки аккаунта на сайте [GitHub](https://github.com).

![](images/1.jpg)

2. Найти пункт *"Development settings"* в левой навигационной панели.

![](images/2.jpg)

3. В появившимся окне, в левой навигационной панели необходимо найти *"Personal access tokens"*. Выбрать *"tokens (
   classic)"*.

![](images/3.jpg)

4. В выбранном разделе нажать на кнопку *"Generate new token"*, выбрать пункт *"Generate new token (classic)"*.

![](images/4.jpg)

5. В появившимся окне заполняем пункт *"Note"*. Выбираем время, через которое token сгорит и в разделе *"Select scopes"*
   выбрать следующие пункты:

- *"Repo"*;
- *"Workflow"*.

![](images/6.jpg)

6. Нажимаем кнопку *"Generate token"*. Нас перекидывает назад на страницу с отображенным кодом. Его необходимо сохранить
   для дальнейшей работы с ним.

![](images/7.jpg)

## Добавление ключа в репозиторий GitHub

1. Открываем **GitHub** репозиторий, к которому необходимо добавить автоматическое создание build-ов.

![](images/8.jpg)

2. В разделе *"Setting"* необходимо найти раздел *"Security"*, в котором выбрать *"Secrets and variables"*. В выпавшем
   списке перейти в *"Actions"*.

![](images/9.jpg)

3. В разделе *"Secrets"* нажать на кнопку *"New repository secret"*.

![](images/10.jpg)

4. В появившемся окне необходимо ввести имя ключа, по которому будем обращаться и сам ключ, который был получен ранее.

![](images/11.jpg)

5. Нажимаем кнопку *"Add secret"*.

## Добавление скрипта для Autodeploy в репозиторий проекта

1. В корневой папке проекта необходимо создать папку *".github"*. В нее необходимо добавить папку *"Workflows"* и файл с
   расширением *".yaml"*.

![](images/12.jpg)

2. Скрипт состоит из таких частей:

- условие, на которое срабатывает скрипт;

![](images/15.jpg)

- название скрипта (в дальнейшем можно использовать, как фильтр);

![](images/16.jpg)

- логика скрипта состоит из следующих частей:

a) получение версионности проекта;

![](images/17.jpg)

b) установка зависимостей;

![](images/18.jpg)

c) запуск тестов;

![](images/19.jpg)

d) сборка *.apk* и .*aab*;

![](images/20.jpg)

e) публикация полученных build-ов в репозиторий проекта, с использованием ранее созданного ключа.

![](images/21.jpg)

3. Чтобы увидеть процесс сборки необходимо на странице репозитория в **GitHub** перейти в раздел *"Actions"*. Тут можно
   увидеть ранее запущенные *"Workflow"* и их статусы.

![](images/22.jpg)

4. Полученные результаты находятся в разделе *"Releases"*.

![](images/23.jpg)
